import{c as t,g as e}from"./unhead-f7d56d88.js";import{n,g as o,i as r,r as s,w as i,a,o as l,b as d,c as u,u as c,v as f}from"./@vue-1d4d5e6e.js";function p(t){return Array.isArray(t)?t:[t]}const h=["title","script","style","noscript"],m=["base","meta","link","style","script","noscript"],g=["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"],y=["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"],v=["tagPosition","tagPriority","tagDuplicateStrategy","innerHTML","textContent"];function b(t){return t}function $(t){let e=9;for(let n=0;n<t.length;)e=Math.imul(e^t.charCodeAt(n++),9**9);return(65536+(e^e>>>9)).toString(16).substring(1,8).toLowerCase()}function A(t){return $(`${t.tag}:${t.textContent||t.innerHTML||""}:${Object.entries(t.props).map((([t,e])=>`${t}:${String(e)}`)).join(",")}`)}function C(t,e){const{props:n,tag:o}=t;if(y.includes(o))return o;if("link"===o&&"canonical"===n.rel)return"canonical";if(n.charset)return"charset";const r=["id"];"meta"===o&&r.push("name","property","http-equiv");for(const s of r)if(void 0!==n[s]){const t=String(n[s]);return!(e&&!e(t))&&`${o}:${s}:${t}`}return!1}const T=(t,e)=>null==t?e||null:"function"==typeof t?t(e):t,w=(t,e=!1,n)=>{const{tag:o,$el:r}=t;r&&(Object.entries(o.props).forEach((([o,s])=>{s=String(s);const i=`attr:${o}`;if("class"!==o)n&&!o.startsWith("data-h-")&&n(t,i,(()=>r.removeAttribute(o))),(e||r.getAttribute(o)!==s)&&r.setAttribute(o,s);else{if(!s)return;for(const e of s.split(" ")){n&&n(t,`${i}:${e}`,(()=>r.classList.remove(e))),r.classList.contains(e)||r.classList.add(e)}}})),h.includes(o.tag)&&(o.textContent&&o.textContent!==r.textContent?r.textContent=o.textContent:o.innerHTML&&o.innerHTML!==r.innerHTML&&(r.innerHTML=o.innerHTML)))};let L=!1;async function _(t,e={}){var n,o;const r={shouldRender:!0};if(await t.hooks.callHook("dom:beforeRender",r),!r.shouldRender)return;const s=e.document||t.resolvedOptions.document||window.document,i=(await t.resolveTags()).map((function(e){const n=t.headEntries().find((t=>t._i===e._e)),o={renderId:!e.key&&e._d?e._d:A(e),$el:null,shouldRender:!0,tag:e,entry:n,markSideEffect:(t,e)=>l(o,t,e)};return o}));if(t.resolvedOptions.experimentalHashHydration&&(L=L||t._hash||!1,L)){const t=function(t){let e=9;for(const n of t)for(let t=0;t<n.length;)e=Math.imul(e^n.charCodeAt(t++),9**9);return(65536+(e^e>>>9)).toString(16).substring(1,8).toLowerCase()}(i.map((t=>t.tag._h)));if(L===t)return;L=t}const a=t._popSideEffectQueue();t.headEntries().map((t=>t._sde)).forEach((t=>{Object.entries(t).forEach((([t,e])=>{a[t]=e}))}));const l=(t,e,n)=>{e=`${t.renderId}:${e}`,t.entry&&(t.entry._sde[e]=n),delete a[e]};const d=[],u={body:[],head:[]},c=e=>{t._elMap[e.renderId]=e.$el,d.push(e),l(e,"el",(()=>{var n;null==(n=e.$el)||n.remove(),delete t._elMap[e.renderId]}))};for(const p of i){if(await t.hooks.callHook("dom:beforeRenderTag",p),!p.shouldRender)continue;const{tag:e}=p;"title"!==e.tag?"htmlAttrs"!==e.tag&&"bodyAttrs"!==e.tag?(p.$el=t._elMap[p.renderId],!p.$el&&e.key&&(p.$el=s.querySelector(`${(null==(n=e.tagPosition)?void 0:n.startsWith("body"))?"body":"head"} > ${e.tag}[data-h-${e._h}]`)),p.$el?(p.tag._d&&w(p),c(p)):u[(null==(o=e.tagPosition)?void 0:o.startsWith("body"))?"body":"head"].push(p)):(p.$el=s["htmlAttrs"===e.tag?"documentElement":"body"],w(p,!1,l),d.push(p)):(s.title=e.textContent||"",d.push(p))}const f={bodyClose:void 0,bodyOpen:void 0,head:void 0};Object.entries(u).forEach((([t,e])=>{var n;if(!e.length)return;const o=null==(n=null==s?void 0:s[t])?void 0:n.children;if(o){for(const t of[...o].reverse()){const n=t.tagName.toLowerCase();if(!m.includes(n))continue;const o={tag:n,props:t.getAttributeNames().reduce(((e,n)=>({...e,[n]:t.getAttribute(n)})),{})};t.innerHTML&&(o.innerHTML=t.innerHTML);const r=A(o);let s=e.findIndex((t=>(null==t?void 0:t.renderId)===r));if(-1===s){const t=C(o);s=e.findIndex((e=>(null==e?void 0:e.tag._d)&&e.tag._d===t))}if(-1!==s){const n=e[s];n.$el=t,w(n),c(n),delete e[s]}}e.forEach((t=>{const e=t.tag.tagPosition||"head";f[e]=f[e]||s.createDocumentFragment(),t.$el||(t.$el=s.createElement(t.tag.tag),w(t,!0)),f[e].appendChild(t.$el),c(t)}))}})),f.head&&s.head.appendChild(f.head),f.bodyOpen&&s.body.insertBefore(f.bodyOpen,s.body.firstChild),f.bodyClose&&s.body.appendChild(f.bodyClose);for(const p of d)await t.hooks.callHook("dom:renderTag",p);Object.values(a).forEach((t=>t()))}let H=null;async function M(t,e={}){const n=e.delayFn||(t=>setTimeout(t,10));return H=H||new Promise((o=>n((()=>o((H=null,_(t,e)))))))}const k=t=>({hooks:{"entries:updated":function(e){if(void 0===(null==t?void 0:t.document)&&"undefined"==typeof window)return;let n=null==t?void 0:t.delayFn;n||"undefined"==typeof requestAnimationFrame||(n=requestAnimationFrame),M(e,{document:(null==t?void 0:t.document)||window.document,delayFn:n})}}});function E(t){var e;return(null==(e=null==t?void 0:t.head.querySelector('meta[name="unhead:ssr"]'))?void 0:e.getAttribute("content"))||!1}function O(t,e=""){if(t instanceof Promise)return t;const n="function"==typeof(o=t)?o():c(o);var o;return t&&n?Array.isArray(n)?n.map((t=>O(t,e))):"object"==typeof n?Object.fromEntries(Object.entries(n).map((([t,e])=>"titleTemplate"===t||t.startsWith("on")?[t,c(e)]:[t,O(e,t)]))):n:n}const x=f.startsWith("3"),P="undefined"!=typeof window,j="usehead";function S(){return o()&&r(j)||e()}function I(e={}){const o=t({...e,domDelayFn:t=>setTimeout((()=>n((()=>t()))),10),plugins:[F(),...(null==e?void 0:e.plugins)||[]]});return o.install=function(t){return{install(e){x&&(e.config.globalProperties.$unhead=t,e.config.globalProperties.$head=t,e.provide(j,t))}}.install}(o),o}const F=()=>({hooks:{"entries:resolve":function(t){for(const e of t.entries)e.resolvedInput=O(e.input)}}});function R(t,e={}){var n;const r=S();if(r){const c=P||!!(null==(n=r.resolvedOptions)?void 0:n.document);if("server"===e.mode&&c||"client"===e.mode&&!c)return;return c?function(t,e={}){const n=S(),r=s(!1),c=s({});i((()=>{c.value=r.value?{}:O(t)}));const f=n.push(c.value,e);return a(c,(t=>{f.patch(t)})),o()&&(l((()=>{f.dispose()})),d((()=>{r.value=!0})),u((()=>{r.value=!1}))),f}(t,e):function(t,e={}){return S().push(t,e)}(t,e)}}export{k as P,v as T,g as V,b as a,T as b,I as c,M as d,$ as e,h as f,p as g,A as h,E as m,_ as r,C as t,R as u};
